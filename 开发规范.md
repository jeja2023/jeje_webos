# JeJe WebOS å¼€å‘è§„èŒƒä¸æ ‡å‡†

> æœ¬æ–‡æ¡£å®šä¹‰äº† JeJe WebOS é¡¹ç›®çš„åº•å±‚å¼€å‘æ ‡å‡†å’Œè§„èŒƒã€‚  
> **æ‰€æœ‰å¼€å‘äººå‘˜åœ¨è¿›è¡ŒåŠŸèƒ½å¼€å‘å‰ï¼Œå¿…é¡»å®Œæ•´é˜…è¯»å¹¶ä¸¥æ ¼éµå®ˆæœ¬è§„èŒƒã€‚**

---

## æ–‡æ¡£è¯´æ˜

### é€‚ç”¨èŒƒå›´

æœ¬è§„èŒƒé€‚ç”¨äºï¼š
- å†…æ ¸å±‚ï¼ˆcoreï¼‰çš„ç»´æŠ¤å’Œæ‰©å±•
- ç³»ç»ŸåŠŸèƒ½ï¼ˆmodels/schemas/routers/utilsï¼‰çš„å¼€å‘
- å¯æ’æ‹”æ¨¡å—ï¼ˆmodulesï¼‰çš„å¼€å‘
- å‰ç«¯é¡µé¢å’Œç»„ä»¶çš„å¼€å‘

### è§„èŒƒç­‰çº§

| æ ‡è¯† | ç­‰çº§ | è¯´æ˜ |
|------|------|------|
| ğŸ”´ **å¿…é¡»** | å¼ºåˆ¶ | è¿åå°†å¯¼è‡´ç³»ç»Ÿå¼‚å¸¸æˆ–æ¶æ„ç ´å |
| ğŸŸ¡ **åº”è¯¥** | æ¨è | è¿åå°†å½±å“ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ |
| ğŸŸ¢ **å¯ä»¥** | å»ºè®® | éµå¾ªå¯æå‡ä»£ç ä¸€è‡´æ€§ |

---

## ä¸€ã€æ¶æ„è§„èŒƒ

### 1.1 å¾®å†…æ ¸æ¶æ„ ğŸ”´å¿…é¡»

ç³»ç»Ÿä¸¥æ ¼åˆ’åˆ†ä¸ºä¸¤ä¸ªå±‚çº§ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åº”ç”¨å±‚ (Modules)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Blog   â”‚  â”‚  Notes  â”‚  â”‚  Maps   â”‚  â”‚  ...    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â”‚
â”‚       â”‚            â”‚            â”‚            â”‚          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    å†…æ ¸å±‚ (Kernel)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Loader   â”‚ â”‚ EventBus â”‚ â”‚ Security â”‚ â”‚ Database â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æ ¸å¿ƒåŸåˆ™ ğŸ”´å¿…é¡»

| åŸåˆ™ | è¯´æ˜ | è¿ååæœ |
|------|------|----------|
| **å•å‘ä¾èµ–** | åªå…è®¸ å†…æ ¸â†’æ¨¡å— æ–¹å‘ä¾èµ– | å¾ªç¯ä¾èµ–ï¼Œç³»ç»Ÿæ— æ³•å¯åŠ¨ |
| **æ¨¡å—éš”ç¦»** | æ¨¡å—é—´ä¸¥ç¦ç›´æ¥import | è€¦åˆåº¦é«˜ï¼Œæ— æ³•ç‹¬ç«‹å¸è½½ |
| **è‡ªåŒ…å«æ€§** | æ¨¡å—å¿…é¡»åŒ…å«å®Œæ•´çš„MVCç»“æ„ | æ¨¡å—ä¸å®Œæ•´ï¼ŒåŠŸèƒ½ç¼ºå¤± |
| **å¯æ’æ‹”æ€§** | åˆ é™¤æ¨¡å—æ–‡ä»¶å¤¹ç³»ç»Ÿä¸å´©æºƒ | ç³»ç»Ÿç¨³å®šæ€§å—æŸ |

### 1.3 å†…æ ¸å±‚èŒè´£ ğŸ”´å¿…é¡»

å†…æ ¸å±‚åªæä¾›é€šç”¨åŸºç¡€è®¾æ–½ï¼Œ**ä¸¥ç¦åŒ…å«ä»»ä½•ä¸šåŠ¡é€»è¾‘**ï¼š

| ç»„ä»¶ | èŒè´£ | ç¦æ­¢è¡Œä¸º |
|------|------|----------|
| `loader.py` | æ¨¡å—æ‰«æã€åŠ è½½ã€æ³¨å†Œ | ä¸å¾—å¤„ç†å…·ä½“ä¸šåŠ¡æ•°æ® |
| `events.py` | äº‹ä»¶å‘å¸ƒ/è®¢é˜…æœºåˆ¶ | ä¸å¾—ç›´æ¥è°ƒç”¨ä¸šåŠ¡å‡½æ•° |
| `security.py` | è®¤è¯é‰´æƒã€æƒé™éªŒè¯ | ä¸å¾—åŒ…å«ä¸šåŠ¡æƒé™åˆ¤æ–­ |
| `database.py` | æ•°æ®åº“è¿æ¥å’Œä¼šè¯ç®¡ç† | ä¸å¾—å®šä¹‰ä¸šåŠ¡è¡¨ç»“æ„ |
| `config.py` | ç³»ç»Ÿé…ç½®ç®¡ç† | ä¸å¾—åŒ…å«ä¸šåŠ¡é…ç½®é¡¹ |

---

## äºŒã€ç›®å½•ç»“æ„è§„èŒƒ

### 2.1 é¡¹ç›®ç›®å½• ğŸ”´å¿…é¡»

```
jeje_webos/
â”œâ”€â”€ backend/                    # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ core/                   # å†…æ ¸å±‚ï¼ˆç¦æ­¢æ·»åŠ ä¸šåŠ¡ä»£ç ï¼‰
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ config.py           # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ database.py         # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â”œâ”€â”€ security.py         # å®‰å…¨è®¤è¯
â”‚   â”‚   â”œâ”€â”€ events.py           # äº‹ä»¶æ€»çº¿
â”‚   â”‚   â”œâ”€â”€ loader.py           # æ¨¡å—åŠ è½½å™¨
â”‚   â”‚   â””â”€â”€ deps.py             # ä¾èµ–æ³¨å…¥
â”‚   â”œâ”€â”€ models/                 # ç³»ç»Ÿæ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ schemas/                # ç³»ç»Ÿæ•°æ®éªŒè¯
â”‚   â”œâ”€â”€ routers/                # ç³»ç»Ÿè·¯ç”±
â”‚   â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ modules/                # å¯æ’æ‹”æ¨¡å—
â”‚   â”œâ”€â”€ storage/                # æ–‡ä»¶å­˜å‚¨
â”‚   â”œâ”€â”€ venv/                   # è™šæ‹Ÿç¯å¢ƒï¼ˆä¸æäº¤åˆ°Gitï¼‰
â”‚   â”œâ”€â”€ main.py                 # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ requirements.txt        # ä¾èµ–æ¸…å•
â”‚   â””â”€â”€ .env.example            # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ frontend/                   # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ css/                    # æ ·å¼
â”‚   â”‚   â”œâ”€â”€ core/               # æ ¸å¿ƒæ ·å¼ï¼ˆå˜é‡ã€é‡ç½®ã€å·¥å…·ï¼‰
â”‚   â”‚   â”œâ”€â”€ components/         # ç»„ä»¶æ ·å¼
â”‚   â”‚   â””â”€â”€ pages/              # é¡µé¢æ ·å¼
â”‚   â”œâ”€â”€ js/                     # è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ core/               # æ ¸å¿ƒé€»è¾‘ï¼ˆé…ç½®ã€APIã€çŠ¶æ€ã€è·¯ç”±ï¼‰
â”‚   â”‚   â”œâ”€â”€ components/         # ç»„ä»¶ç±»
â”‚   â”‚   â””â”€â”€ pages/              # é¡µé¢ç±»
â”‚   â””â”€â”€ index.html              # SPAå•å…¥å£
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â””â”€â”€ SPECIFICATION.md            # æœ¬è§„èŒƒæ–‡æ¡£
```

### 2.2 æ¨¡å—ç›®å½• ğŸ”´å¿…é¡»

æ¯ä¸ªæ¨¡å—å¿…é¡»éµå¾ªä»¥ä¸‹ç»“æ„ï¼š

```
modules/{module_id}/
â”œâ”€â”€ __init__.py         # åŒ…åˆå§‹åŒ–ï¼ˆå¿…é¡»ï¼‰
â”œâ”€â”€ manifest.py         # æ¨¡å—æ¸…å•ï¼ˆå¿…é¡»ï¼‰
â”œâ”€â”€ models.py           # æ•°æ®æ¨¡å‹ï¼ˆå¿…é¡»ï¼‰
â”œâ”€â”€ schemas.py          # æ•°æ®éªŒè¯ï¼ˆå¿…é¡»ï¼‰
â”œâ”€â”€ router.py           # è·¯ç”±å®šä¹‰ï¼ˆå¿…é¡»ï¼‰
â”œâ”€â”€ services.py         # ä¸šåŠ¡é€»è¾‘ï¼ˆå¿…é¡»ï¼‰
â””â”€â”€ static/             # é™æ€èµ„æºï¼ˆå¯é€‰ï¼‰
```

---

## ä¸‰ã€å‘½åè§„èŒƒ

### 3.1 æ–‡ä»¶å‘½å ğŸ”´å¿…é¡»

| è§„åˆ™ | æ­£ç¡®ç¤ºä¾‹ | é”™è¯¯ç¤ºä¾‹ |
|------|----------|----------|
| å…¨å°å†™å­—æ¯ | `auth.py` | `Auth.py`, `AUTH.py` |
| ä¸‹åˆ’çº¿åˆ†éš” | `blog_post.py` | `blogPost.py`, `blog-post.py` |
| ç®€çŸ­å‡†ç¡® | `config.py` | `system_configuration_manager.py` |
| ç¦æ­¢é‡å¤ | ä¸åŒç›®å½•ä¸å¾—æœ‰åŒåæ–‡ä»¶ | `models/user.py` å’Œ `schemas/user.py` |

### 3.2 å·²å ç”¨æ–‡ä»¶å ğŸ”´å¿…é¡»

ä»¥ä¸‹æ–‡ä»¶åå·²è¢«å ç”¨ï¼Œåˆ›å»ºæ–°æ–‡ä»¶æ—¶**ç¦æ­¢ä½¿ç”¨**ï¼š

**åç«¯å·²å ç”¨ï¼š**
```
core/: config, database, security, events, loader, deps
models/: account, config
schemas/: auth, module, response
routers/: auth, boot
utils/: text, request
modules/å†…éƒ¨: manifest, models, schemas, router, services
```

**å‰ç«¯å·²å ç”¨ï¼š**
```
css/core/: variables, reset, utils
css/components/: button, card, form, table, tag, modal, toast, pagination, sidebar, header
css/pages/: layout, login, dashboard, blog
js/core/: config, api, store, router, component
js/components/: header, sidebar, modal, toast
js/pages/: app, login, dashboard, blog
html/: index
```

### 3.3 å˜é‡å‘½å ğŸ”´å¿…é¡»

| ç±»å‹ | Pythonè§„èŒƒ | JavaScriptè§„èŒƒ |
|------|------------|----------------|
| å˜é‡ | `snake_case` | `camelCase` |
| å‡½æ•° | `snake_case` | `camelCase` |
| ç±» | `PascalCase` | `PascalCase` |
| å¸¸é‡ | `UPPER_SNAKE_CASE` | `UPPER_SNAKE_CASE` |
| ç§æœ‰ | `_leading_underscore` | `_leadingUnderscore` |

### 3.4 æ•°æ®åº“è¡¨å‘½å ğŸ”´å¿…é¡»

| ç±»å‹ | å‰ç¼€è§„åˆ™ | ç¤ºä¾‹ |
|------|----------|------|
| ç³»ç»Ÿè¡¨ | `sys_` | `sys_users`, `sys_modules`, `sys_logs` |
| æ¨¡å—è¡¨ | `{module_id}_` | `blog_posts`, `blog_categories` |
| å…³è”è¡¨ | `{module_id}_{a}_{b}` | `blog_post_tags` |

---

## å››ã€APIè§„èŒƒ

### 4.1 URLè®¾è®¡ ğŸ”´å¿…é¡»

| è§„åˆ™ | æ­£ç¡® | é”™è¯¯ |
|------|------|------|
| RESTfulé£æ ¼ | `/api/v1/posts` | `/api/v1/getPostList` |
| èµ„æºå¤æ•°å½¢å¼ | `/api/v1/users` | `/api/v1/user` |
| å¸¦ç‰ˆæœ¬å· | `/api/v1/...` | `/api/...` |
| æ— å†—ä½™è¯æ±‡ | `/api/v1/blog` | `/api/v1/backend/blog` |
| çº¯å°å†™å­—æ¯ | `/api/v1/blog-posts` | `/api/v1/blogPosts` |

### 4.2 HTTPæ–¹æ³• ğŸ”´å¿…é¡»

| æ–¹æ³• | ç”¨é€” | å¹‚ç­‰æ€§ | ç¤ºä¾‹ |
|------|------|--------|------|
| GET | æŸ¥è¯¢èµ„æº | æ˜¯ | `GET /api/v1/posts` |
| POST | åˆ›å»ºèµ„æº | å¦ | `POST /api/v1/posts` |
| PUT | å…¨é‡æ›´æ–° | æ˜¯ | `PUT /api/v1/posts/{id}` |
| PATCH | éƒ¨åˆ†æ›´æ–° | æ˜¯ | `PATCH /api/v1/posts/{id}` |
| DELETE | åˆ é™¤èµ„æº | æ˜¯ | `DELETE /api/v1/posts/{id}` |

### 4.3 å“åº”æ ¼å¼ ğŸ”´å¿…é¡»

**æ ‡å‡†å“åº”ï¼š**
```json
{
    "code": 200,
    "message": "æ“ä½œæˆåŠŸ",
    "data": { ... }
}
```

**åˆ†é¡µå“åº”ï¼š**
```json
{
    "code": 200,
    "message": "æ“ä½œæˆåŠŸ",
    "data": {
        "items": [...],
        "total": 100,
        "page": 1,
        "size": 20,
        "pages": 5
    }
}
```

**é”™è¯¯å“åº”ï¼š**
```json
{
    "code": 400,
    "message": "è¯·æ±‚å‚æ•°é”™è¯¯",
    "data": null
}
```

### 4.4 çŠ¶æ€ç å®šä¹‰ ğŸ”´å¿…é¡»

| ç å€¼ | å«ä¹‰ | ä½¿ç”¨åœºæ™¯ |
|------|------|----------|
| 200 | æˆåŠŸ | è¯·æ±‚å¤„ç†æˆåŠŸ |
| 400 | å‚æ•°é”™è¯¯ | è¯·æ±‚å‚æ•°ä¸åˆæ³• |
| 401 | æœªè®¤è¯ | æœªç™»å½•æˆ–Tokenå¤±æ•ˆ |
| 403 | æ— æƒé™ | å·²ç™»å½•ä½†æƒé™ä¸è¶³ |
| 404 | ä¸å­˜åœ¨ | èµ„æºæœªæ‰¾åˆ° |
| 500 | æœåŠ¡å™¨é”™è¯¯ | æœåŠ¡ç«¯å¼‚å¸¸ |

---

## äº”ã€æ¨¡å—å¼€å‘è§„èŒƒ

### 5.1 æ¸…å•åè®® ğŸ”´å¿…é¡»

æ¯ä¸ªæ¨¡å—**å¿…é¡»**æä¾› `manifest.py` æ–‡ä»¶ï¼š

```python
"""
{æ¨¡å—åç§°}æ¨¡å—æ¸…å•
å®šä¹‰æ¨¡å—å…ƒä¿¡æ¯ã€è·¯ç”±ã€èœå•ã€æƒé™
"""

from core.loader import ModuleManifest

manifest = ModuleManifest(
    # === å¿…å¡«å­—æ®µ ===
    id="blog",                          # å”¯ä¸€æ ‡è¯†ï¼Œå¿…é¡»ä¸æ–‡ä»¶å¤¹åä¸€è‡´
    name="åšå®¢",                         # æ˜¾ç¤ºåç§°
    version="1.0.0",                    # è¯­ä¹‰åŒ–ç‰ˆæœ¬å·
    
    # === é€‰å¡«å­—æ®µ ===
    description="æ–‡ç« å‘å¸ƒä¸ç®¡ç†ç³»ç»Ÿ",     # æ¨¡å—æè¿°
    icon="ğŸ“",                          # å›¾æ ‡ï¼ˆEmojiæˆ–å›¾ç‰‡è·¯å¾„ï¼‰
    author="ä½œè€…å",                     # ä½œè€…ä¿¡æ¯
    
    # === è·¯ç”±é…ç½® ===
    router_prefix="/api/v1/blog",       # APIè·¯ç”±å‰ç¼€
    
    # === èœå•é…ç½® ===
    menu={
        "title": "åšå®¢",
        "icon": "ğŸ“",
        "path": "/blog",
        "order": 1,                     # èœå•æ’åºï¼ˆæ•°å­—è¶Šå°è¶Šé å‰ï¼‰
        "children": [
            {"title": "æ–‡ç« åˆ—è¡¨", "path": "/blog/list", "icon": "ğŸ“„"},
            {"title": "å‘å¸ƒæ–‡ç« ", "path": "/blog/edit", "icon": "âœï¸"},
            {"title": "åˆ†ç±»ç®¡ç†", "path": "/blog/category", "icon": "ğŸ“"}
        ]
    },
    
    # === æƒé™å£°æ˜ ===
    permissions=[
        "blog.read",                    # æ ¼å¼ï¼š{module_id}.{action}
        "blog.create",
        "blog.update",
        "blog.delete"
    ],
    
    # === çŠ¶æ€ ===
    enabled=True                        # æ˜¯å¦å¯ç”¨
)
```

### 5.2 æ•°æ®åº“åè®® ğŸ”´å¿…é¡»

```python
"""
{æ¨¡å—åç§°}æ•°æ®æ¨¡å‹
è¡¨åå¿…é¡»ä½¿ç”¨ {module_id}_ å‰ç¼€
"""

from datetime import datetime
from typing import Optional
from sqlalchemy import String, Integer, DateTime, Text
from sqlalchemy.orm import Mapped, mapped_column

from core.database import Base


class BlogPost(Base):
    """åšå®¢æ–‡ç« è¡¨"""
    __tablename__ = "blog_posts"  # å¿…é¡»å¸¦æ¨¡å—å‰ç¼€
    
    id: Mapped[int] = mapped_column(Integer, primary_key=True, autoincrement=True)
    title: Mapped[str] = mapped_column(String(200))
    content: Mapped[str] = mapped_column(Text)
    created_at: Mapped[datetime] = mapped_column(DateTime, default=datetime.utcnow)
```

### 5.3 è·¯ç”±è§„èŒƒ ğŸ”´å¿…é¡»

```python
"""
{æ¨¡å—åç§°}APIè·¯ç”±
"""

from fastapi import APIRouter, Depends
from core.database import get_db
from core.security import get_current_user, require_permission
from schemas import success, paginate  # ä»ç³»ç»Ÿschemaså¯¼å…¥

router = APIRouter()  # ä¸è®¾ç½®prefixï¼Œç”±loaderè‡ªåŠ¨æ·»åŠ 


@router.get("/posts")
async def list_posts(db = Depends(get_db)):
    """è·å–æ–‡ç« åˆ—è¡¨"""
    # ... ä¸šåŠ¡é€»è¾‘
    return success(data)


@router.post("/posts")
async def create_post(
    data: PostCreate,
    user = Depends(require_permission("blog.create")),  # æƒé™éªŒè¯
    db = Depends(get_db)
):
    """åˆ›å»ºæ–‡ç« """
    # ... ä¸šåŠ¡é€»è¾‘
    return success({"id": post.id}, "åˆ›å»ºæˆåŠŸ")
```

### 5.4 å¯¼å…¥è§„èŒƒ ğŸ”´å¿…é¡»

```python
# âœ… æ­£ç¡®ï¼šä»coreå¯¼å…¥åŸºç¡€è®¾æ–½
from core.database import get_db, Base
from core.security import get_current_user, require_permission
from core.events import event_bus, Events
from core.config import get_settings

# âœ… æ­£ç¡®ï¼šä»ç³»ç»Ÿschemaså¯¼å…¥å“åº”å·¥å…·
from schemas import success, paginate, error

# âœ… æ­£ç¡®ï¼šä»æ¨¡å—å†…éƒ¨å¯¼å…¥
from .models import BlogPost
from .schemas import PostCreate
from .services import BlogService

# âŒ é”™è¯¯ï¼šç›´æ¥å¯¼å…¥å…¶ä»–æ¨¡å—
from modules.notes import NoteService  # ç¦æ­¢ï¼
```

### 5.5 æ¨¡å—å¼€å‘æ£€æŸ¥æ¸…å• ğŸ”´å¿…é¡»

åˆ›å»ºæ–°æ¨¡å—å‰ï¼Œå¿…é¡»ç¡®è®¤ä»¥ä¸‹äº‹é¡¹ï¼š

- [ ] æ¨¡å—IDæœªè¢«å ç”¨
- [ ] è¡¨åå‰ç¼€ä¸æ¨¡å—IDä¸€è‡´
- [ ] æƒé™å‘½åæ ¼å¼ä¸º `{module_id}.{action}`
- [ ] manifest.py åŒ…å«æ‰€æœ‰å¿…å¡«å­—æ®µ
- [ ] è·¯ç”±æœªè®¾ç½®prefixï¼ˆç”±loaderæ·»åŠ ï¼‰
- [ ] æ— ç›´æ¥importå…¶ä»–æ¨¡å—
- [ ] æ‰€æœ‰æ³¨é‡Šä½¿ç”¨ä¸­æ–‡
- [ ] æ‰€æœ‰æ¨¡å—æ–‡ä»¶åæ·»åŠ æ¨¡å—å‰ç¼€ï¼ˆå¦‚ `blog_models.py`ï¼‰

### 5.6 å·²å®ç°æ¨¡å—æ¸…å• ğŸŸ¢å‚è€ƒ

ç³»ç»Ÿå½“å‰å·²å®ç°ä»¥ä¸‹æ¨¡å—ï¼š

| æ¨¡å—ID | åç§° | è·¯ç”±å‰ç¼€ | æ•°æ®è¡¨ | æ ¸å¿ƒåŠŸèƒ½ |
|--------|------|----------|--------|----------|
| `blog` | åšå®¢ | `/api/v1/blog` | `blog_posts`, `blog_categories`, `blog_tags`, `blog_post_tags` | æ–‡ç« å‘å¸ƒã€åˆ†ç±»ç®¡ç†ã€æ ‡ç­¾ç®¡ç† |
| `notes` | ç¬”è®° | `/api/v1/notes` | `notes_folders`, `notes_notes`, `notes_tags`, `notes_note_tags` | æ— é™å±‚çº§ç›®å½•ã€ä¸ªäººç¬”è®°ã€ç”¨æˆ·éš”ç¦» |

**åšå®¢æ¨¡å—ï¼ˆBlogï¼‰**ï¼š
- æ–‡ä»¶æ¸…å•ï¼š`blog_manifest.py`, `blog_models.py`, `blog_router.py`, `blog_schemas.py`, `blog_services.py`
- æƒé™ï¼š`blog.read`, `blog.create`, `blog.update`, `blog.delete`
- ç‰¹æ€§ï¼šæ”¯æŒåˆ†ç±»ã€æ ‡ç­¾ã€è‰ç¨¿/å‘å¸ƒçŠ¶æ€ã€ç½®é¡¶ã€æµè§ˆé‡ç»Ÿè®¡

**ç¬”è®°æ¨¡å—ï¼ˆNotesï¼‰**ï¼š
- æ–‡ä»¶æ¸…å•ï¼š`notes_manifest.py`, `notes_models.py`, `notes_router.py`, `notes_schemas.py`, `notes_services.py`
- æƒé™ï¼š`notes.read`, `notes.create`, `notes.update`, `notes.delete`
- ç‰¹æ€§ï¼šæ— é™å±‚çº§æ–‡ä»¶å¤¹ã€ç”¨æˆ·ä¸¥æ ¼éš”ç¦»ã€æ”¶è—/ç½®é¡¶ã€æ ‡ç­¾ç³»ç»Ÿã€Markdownæ”¯æŒã€è‡ªåŠ¨ä¿å­˜

---

## å…­ã€å‰ç«¯å¼€å‘è§„èŒƒ

### 6.1 ç»„ä»¶å¼€å‘ ğŸ”´å¿…é¡»

æ‰€æœ‰é¡µé¢ç»„ä»¶å¿…é¡»ç»§æ‰¿ `Component` åŸºç±»ï¼š

```javascript
/**
 * {ç»„ä»¶åç§°}ç»„ä»¶
 * {ç»„ä»¶åŠŸèƒ½æè¿°}
 */
class MyComponent extends Component {
    constructor(container) {
        super(container);
        this.state = {
            // ç»„ä»¶çŠ¶æ€
        };
    }
    
    /**
     * æ¸²æŸ“ç»„ä»¶
     */
    render() {
        return `
            <div class="my-component">
                ${this.state.title}
            </div>
        `;
    }
    
    /**
     * æŒ‚è½½åæ‰§è¡Œ
     */
    afterMount() {
        // ç»‘å®šäº‹ä»¶
        this.on('.btn', 'click', () => { /* å¤„ç†ç‚¹å‡» */ });
    }
}
```

### 6.2 çŠ¶æ€ç®¡ç† ğŸ”´å¿…é¡»

ä½¿ç”¨å…¨å±€ `Store` ç®¡ç†å…±äº«çŠ¶æ€ï¼š

```javascript
// è®¾ç½®çŠ¶æ€
Store.set('user', userData);

// è·å–çŠ¶æ€
const user = Store.get('user');

// è®¢é˜…çŠ¶æ€å˜åŒ–
Store.subscribe('user', (newValue, oldValue) => {
    console.log('ç”¨æˆ·çŠ¶æ€å˜åŒ–');
});
```

### 6.3 APIè°ƒç”¨ ğŸ”´å¿…é¡»

ä½¿ç”¨å°è£…çš„ `Api` æ¨¡å—è¿›è¡Œè¯·æ±‚ï¼š

```javascript
// åŸºç¡€è¯·æ±‚
const data = await Api.get('/blog/posts');
const result = await Api.post('/blog/posts', { title: 'æ ‡é¢˜' });
const updated = await Api.put('/blog/posts/1', { title: 'æ–°æ ‡é¢˜' });
await Api.delete('/blog/posts/1');

// æ·»åŠ æ¨¡å—APIå°è£…
const BlogApi = {
    getPosts: (params) => Api.get('/blog/posts', params),
    createPost: (data) => Api.post('/blog/posts', data),
    updatePost: (id, data) => Api.put(`/blog/posts/${id}`, data),
    deletePost: (id) => Api.delete(`/blog/posts/${id}`)
};
```

### 6.4 è·¯ç”±ä½¿ç”¨ ğŸ”´å¿…é¡»

```javascript
// æ³¨å†Œè·¯ç”±ï¼ˆåœ¨app.jsä¸­ï¼‰
Router.register('/blog', BlogPage);
Router.register('/blog/:id', BlogDetailPage);

// é¡µé¢å¯¼èˆª
Router.push('/blog');           // è·³è½¬
Router.replace('/login');       // æ›¿æ¢ï¼ˆæ— å†å²è®°å½•ï¼‰
Router.back();                  // è¿”å›

// è·å–è·¯ç”±å‚æ•°
const { path, query, params } = Router.current();
```

---

## ä¸ƒã€ç¦æ­¢äº‹é¡¹ï¼ˆä¸‰å¤§æˆ’å¾‹ï¼‰

### 7.1 ğŸ”´æˆ’å¾‹ä¸€ï¼šä¸¥ç¦åç«¯æ¸²æŸ“

**ç¦æ­¢ä½¿ç”¨æ¨¡æ¿å¼•æ“æ¸²æŸ“HTMLï¼š**

```python
# âŒ ç¦æ­¢
from fastapi.templating import Jinja2Templates
templates = Jinja2Templates(directory="templates")

@router.get("/")
def index(request: Request):
    return templates.TemplateResponse("index.html", {"data": data})
```

**å¿…é¡»è¿”å›çº¯JSONæ•°æ®ï¼š**

```python
# âœ… æ­£ç¡®
@router.get("/posts")
def get_posts():
    return success(posts)
```

### 7.2 ğŸ”´æˆ’å¾‹äºŒï¼šä¸¥ç¦æ¨¡å—é—´ç›´æ¥å¯¼å…¥

**ç¦æ­¢è·¨æ¨¡å—importï¼š**

```python
# âŒ ç¦æ­¢
# åœ¨ blog æ¨¡å—ä¸­
from modules.notes import get_note
from modules.maps.models import MapPoint
```

**æ­£ç¡®çš„æ¨¡å—é—´é€šä¿¡æ–¹å¼ï¼š**

```python
# âœ… æ–¹å¼ä¸€ï¼šé€šè¿‡HTTP API
import httpx
async with httpx.AsyncClient() as client:
    response = await client.get("http://localhost:8000/api/v1/notes/123")

# âœ… æ–¹å¼äºŒï¼šé€šè¿‡äº‹ä»¶æ€»çº¿
from core.events import event_bus
event_bus.emit("note.requested", "blog", {"note_id": 123})
```

### 7.3 ğŸ”´æˆ’å¾‹ä¸‰ï¼šä¸¥ç¦å¾ªç¯ä¾èµ–

```
âœ… å…è®¸ï¼šcore â†’ modulesï¼ˆå†…æ ¸å¯è¢«æ¨¡å—ä¾èµ–ï¼‰
âœ… å…è®¸ï¼šmodules â†’ coreï¼ˆæ¨¡å—å¯ä¾èµ–å†…æ ¸ï¼‰
âŒ ç¦æ­¢ï¼šmodule_a â†’ module_bï¼ˆæ¨¡å—é—´ç¦æ­¢ä¾èµ–ï¼‰
âŒ ç¦æ­¢ï¼šcore â†’ modules â†’ coreï¼ˆå¾ªç¯ä¾èµ–ï¼‰
```

---

## å…«ã€æ³¨é‡Šè§„èŒƒ

### 8.1 è¯­è¨€è¦æ±‚ ğŸ”´å¿…é¡»

**æ‰€æœ‰æ³¨é‡Šå’Œæç¤ºæ–‡å­—å¿…é¡»ä½¿ç”¨ä¸­æ–‡ã€‚**

### 8.2 Pythonæ³¨é‡Š ğŸ”´å¿…é¡»

```python
"""
æ¨¡å—æ–‡æ¡£å­—ç¬¦ä¸²
æè¿°æ¨¡å—çš„åŠŸèƒ½å’Œç”¨é€”
"""

class MyClass:
    """ç±»æ–‡æ¡£å­—ç¬¦ä¸²"""
    
    def my_method(self, param: str) -> bool:
        """
        æ–¹æ³•æ–‡æ¡£å­—ç¬¦ä¸²
        
        Args:
            param: å‚æ•°è¯´æ˜
            
        Returns:
            è¿”å›å€¼è¯´æ˜
        """
        # å•è¡Œæ³¨é‡Šï¼šè§£é‡Šå¤æ‚é€»è¾‘
        pass
```

### 8.3 JavaScriptæ³¨é‡Š ğŸ”´å¿…é¡»

```javascript
/**
 * å‡½æ•°è¯´æ˜
 * @param {string} param - å‚æ•°è¯´æ˜
 * @returns {boolean} è¿”å›å€¼è¯´æ˜
 */
function myFunction(param) {
    // å•è¡Œæ³¨é‡Šï¼šè§£é‡Šå¤æ‚é€»è¾‘
    return true;
}
```

---

## ä¹ã€äº‹ä»¶æ€»çº¿è§„èŒƒ

### 9.1 ç³»ç»Ÿé¢„å®šä¹‰äº‹ä»¶ ğŸ”´å¿…é¡»

| äº‹ä»¶å | è§¦å‘æ—¶æœº | æ•°æ®æ ¼å¼ |
|--------|----------|----------|
| `system.startup` | ç³»ç»Ÿå¯åŠ¨å®Œæˆ | `{}` |
| `system.shutdown` | ç³»ç»Ÿå…³é—­å‰ | `{}` |
| `module.loaded` | æ¨¡å—åŠ è½½æˆåŠŸ | `{module_id: string}` |
| `module.unloaded` | æ¨¡å—å¸è½½æˆåŠŸ | `{module_id: string}` |
| `user.login` | ç”¨æˆ·ç™»å½• | `{user_id: int}` |
| `user.logout` | ç”¨æˆ·ç™»å‡º | `{user_id: int}` |
| `user.register` | ç”¨æˆ·æ³¨å†Œ | `{user_id: int}` |
| `content.created` | å†…å®¹åˆ›å»º | `{type: string, id: int}` |
| `content.updated` | å†…å®¹æ›´æ–° | `{type: string, id: int}` |
| `content.deleted` | å†…å®¹åˆ é™¤ | `{type: string, id: int}` |

### 9.2 è‡ªå®šä¹‰äº‹ä»¶å‘½å ğŸŸ¡åº”è¯¥

```
{module_id}.{resource}.{action}

ç¤ºä¾‹ï¼š
- blog.post.created
- blog.post.published
- notes.folder.moved
```

### 9.3 äº‹ä»¶ä½¿ç”¨ç¤ºä¾‹

```python
from core.events import event_bus, Events

# è®¢é˜…äº‹ä»¶
async def on_user_login(event):
    print(f"ç”¨æˆ·ç™»å½•: {event.data['user_id']}")

event_bus.subscribe(Events.USER_LOGIN, on_user_login)

# å‘å¸ƒäº‹ä»¶
event_bus.emit("blog.post.created", "blog", {
    "type": "post",
    "id": 123,
    "title": "æ–‡ç« æ ‡é¢˜"
})
```

---

## åã€å®‰å…¨è§„èŒƒ

### 10.1 å¯†ç å¤„ç† ğŸ”´å¿…é¡»

```python
from core.security import hash_password, verify_password

# å­˜å‚¨æ—¶åŠ å¯†
hashed = hash_password("ç”¨æˆ·å¯†ç ")

# éªŒè¯æ—¶æ¯”å¯¹
is_valid = verify_password("ç”¨æˆ·è¾“å…¥", hashed)
```

**ç¦æ­¢ï¼š**
- æ˜æ–‡å­˜å‚¨å¯†ç 
- ä½¿ç”¨MD5/SHA1ç­‰å¼±åŠ å¯†
- åœ¨æ—¥å¿—ä¸­æ‰“å°å¯†ç 

### 10.2 JWT Tokenç®¡ç† ğŸ”´å¿…é¡»

```python
from core.security import create_token, decode_token, TokenData

# åˆ›å»ºToken
token_data = TokenData(user_id=1, username="admin", role="admin")
token = create_token(token_data)

# éªŒè¯Token
data = decode_token(token)
```

**JWTå¯†é’¥è½®æ¢æœºåˆ¶ï¼ˆæ¨èï¼‰ï¼š**

ç³»ç»Ÿæ”¯æŒ**å¯†é’¥è½®æ¢**ï¼Œæ— éœ€åœæ­¢æœåŠ¡ï¼š

1. **é€šè¿‡APIè½®æ¢å¯†é’¥**ï¼ˆæ¨èï¼‰
   ```bash
   # è°ƒç”¨å¯†é’¥è½®æ¢æ¥å£ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
   POST /api/v1/system/jwt/rotate
   ```

2. **æ‰‹åŠ¨è½®æ¢å¯†é’¥**
   ```bash
   # 1. ç”Ÿæˆæ–°å¯†é’¥
   python -c "import secrets; print(secrets.token_urlsafe(64))"
   
   # 2. ç¼–è¾‘ .env æ–‡ä»¶
   # å°†å½“å‰ JWT_SECRET çš„å€¼å¤åˆ¶åˆ° JWT_SECRET_OLD
   # å°†æ–°å¯†é’¥è®¾ç½®ä¸º JWT_SECRET
   
   # 3. è°ƒç”¨é‡è½½é…ç½®æ¥å£ï¼ˆå¦‚æœå®ç°äº†ï¼‰
   # æˆ–ç­‰å¾…ç¨‹åºè‡ªåŠ¨æ£€æµ‹é…ç½®å˜åŒ–
   ```

**å¯†é’¥è½®æ¢çš„ä¼˜åŠ¿ï¼š**

âœ… **æ— éœ€åœæ­¢æœåŠ¡** - æœåŠ¡æŒç»­è¿è¡Œï¼Œç”¨æˆ·ä½“éªŒä¸å—å½±å“  
âœ… **å¹³æ»‘è¿‡æ¸¡** - æ–°æ—§å¯†é’¥åŒæ—¶æœ‰æ•ˆï¼Œæ—§Tokenä»å¯ä½¿ç”¨  
âœ… **é›¶åœæœº** - æ–°ç­¾å‘çš„Tokenä½¿ç”¨æ–°å¯†é’¥ï¼Œæ—§Tokené€æ­¥è¿‡æœŸ  
âœ… **å®‰å…¨å¯æ§** - ç­‰å¾…æ‰€æœ‰æ—§Tokenè¿‡æœŸåï¼Œå¯ç§»é™¤æ—§å¯†é’¥  
âœ… **è‡ªåŠ¨è½®æ¢** - æ”¯æŒå®šæœŸè‡ªåŠ¨è½®æ¢ï¼Œæ— éœ€äººå·¥å¹²é¢„  

**å¯†é’¥è½®æ¢æµç¨‹ï¼š**

```
1. å½“å‰å¯†é’¥: JWT_SECRET = "old_key"
2. è½®æ¢æ“ä½œ: 
   - JWT_SECRET_OLD = "old_key"  (ä¿ç•™æ—§å¯†é’¥)
   - JWT_SECRET = "new_key"      (è®¾ç½®æ–°å¯†é’¥)
   - JWT_ROTATE_TIMESTAMP = "2025-12-05T02:00:00"  (è®°å½•è½®æ¢æ—¶é—´)
3. éªŒè¯é€»è¾‘:
   - æ–°Token: ä½¿ç”¨ new_key ç­¾åå’ŒéªŒè¯
   - æ—§Token: å…ˆç”¨ new_key éªŒè¯ï¼Œå¤±è´¥åˆ™ç”¨ old_key éªŒè¯
4. è¿‡æ¸¡æœŸ: ç­‰å¾…æ‰€æœ‰æ—§Tokenè¿‡æœŸï¼ˆé€šå¸¸7å¤©ï¼‰
5. æ¸…ç†: ç§»é™¤ JWT_SECRET_OLDï¼Œä»…ä¿ç•™æ–°å¯†é’¥
```

**è‡ªåŠ¨è½®æ¢æœºåˆ¶ï¼š**

ç³»ç»Ÿæ”¯æŒè‡ªåŠ¨å®šæœŸè½®æ¢JWTå¯†é’¥ï¼Œé‡‡ç”¨**éšæœºé—´éš”**ç­–ç•¥æé«˜å®‰å…¨æ€§ï¼š

```env
# å¯ç”¨è‡ªåŠ¨è½®æ¢
JWT_AUTO_ROTATE=true

# éšæœºè½®æ¢é—´éš”èŒƒå›´ï¼ˆå¤©ï¼‰
JWT_ROTATE_INTERVAL_MIN=25  # æœ€å°é—´éš”
JWT_ROTATE_INTERVAL_MAX=35  # æœ€å¤§é—´éš”

# æ¯æ—¥æ£€æŸ¥æ—¶é—´ï¼ˆå‡Œæ™¨2ç‚¹ï¼‰
JWT_ROTATE_CHECK_HOUR=2
JWT_ROTATE_CHECK_MINUTE=0
```

**éšæœºé—´éš”çš„ä¼˜åŠ¿ï¼š**

âœ… **ä¸å¯é¢„æµ‹æ€§** - æ”»å‡»è€…æ— æ³•é¢„æµ‹ä¸‹æ¬¡è½®æ¢æ—¶é—´  
âœ… **å®‰å…¨æ€§æå‡** - å‡å°‘å›ºå®šæ¨¡å¼å¸¦æ¥çš„å®‰å…¨é£é™©  
âœ… **çµæ´»é…ç½®** - å¯è‡ªå®šä¹‰é—´éš”èŒƒå›´ï¼ˆå¦‚25-35å¤©ï¼‰  

**è‡ªåŠ¨è½®æ¢ç­–ç•¥ï¼š**

1. **æ¯æ—¥æ£€æŸ¥**ï¼šåœ¨æŒ‡å®šæ—¶é—´ï¼ˆé»˜è®¤å‡Œæ™¨2ç‚¹ï¼‰æ£€æŸ¥æ˜¯å¦éœ€è¦è½®æ¢
2. **æ—¶é—´åˆ¤æ–­**ï¼š
   - å¦‚æœå­˜åœ¨æ—§å¯†é’¥ï¼Œè·³è¿‡ï¼ˆç­‰å¾…è¿‡æ¸¡æœŸï¼‰
   - å¦‚æœå¯†é’¥æ˜¯é»˜è®¤å€¼ï¼Œç«‹å³è½®æ¢
   - æ£€æŸ¥è®°å½•çš„ä¸‹æ¬¡è½®æ¢æ—¶é—´ï¼ˆ`JWT_NEXT_ROTATE_TIME`ï¼‰
   - å¦‚æœå½“å‰æ—¶é—´ >= ä¸‹æ¬¡è½®æ¢æ—¶é—´ï¼Œåˆ™æ‰§è¡Œè½®æ¢
3. **éšæœºé—´éš”ç”Ÿæˆ**ï¼š
   - æ¯æ¬¡è½®æ¢åï¼Œåœ¨é…ç½®çš„èŒƒå›´å†…éšæœºç”Ÿæˆä¸‹æ¬¡è½®æ¢é—´éš”
   - ä¾‹å¦‚ï¼š25-35å¤©èŒƒå›´å†…ï¼Œå¯èƒ½ç”Ÿæˆ28å¤©ã€31å¤©ã€33å¤©ç­‰
   - è®°å½•ä¸‹æ¬¡è½®æ¢çš„ç²¾ç¡®æ—¶é—´
4. **è‡ªåŠ¨è®°å½•**ï¼š
   - `JWT_ROTATE_TIMESTAMP` - ä¸Šæ¬¡è½®æ¢æ—¶é—´
   - `JWT_NEXT_ROTATE_TIME` - ä¸‹æ¬¡è½®æ¢æ—¶é—´ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰
5. **æ— éœ€é‡å¯**ï¼šè½®æ¢åç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯æœåŠ¡

**æ‰‹åŠ¨è½®æ¢APIï¼š**

```bash
# æ‰‹åŠ¨è½®æ¢ï¼ˆç®¡ç†å‘˜æƒé™ï¼‰
POST /api/v1/system/jwt/rotate?force=false

# æ¸…ç†æ—§å¯†é’¥ï¼ˆè¿‡æ¸¡æœŸç»“æŸåï¼‰
POST /api/v1/system/jwt/cleanup
```

**æœ€ä½³å®è·µï¼š**

| åœºæ™¯ | å»ºè®® |
|------|------|
| **æ­£å¸¸è½®æ¢** | ä½¿ç”¨APIæ¥å£ï¼Œæ— éœ€åœæ­¢æœåŠ¡ |
| **å®‰å…¨äº‹ä»¶** | ç«‹å³è½®æ¢ï¼Œæ—§å¯†é’¥ä¿ç•™7å¤© |
| **å®šæœŸç»´æŠ¤** | æ¯3-6ä¸ªæœˆè½®æ¢ä¸€æ¬¡ |
| **å¼€å‘ç¯å¢ƒ** | å¯ä»¥éšæ—¶è½®æ¢æˆ–é‡å¯ |

**é…ç½®åŠ è½½æœºåˆ¶ï¼š**

- æ”¯æŒè¿è¡Œæ—¶é‡æ–°åŠ è½½é…ç½®ï¼ˆ`reload_settings()`ï¼‰
- å¯†é’¥è½®æ¢åç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯
- æ—§å¯†é’¥è‡ªåŠ¨ä¿ç•™ç”¨äºéªŒè¯æ—§Token

### 10.3 æƒé™éªŒè¯ ğŸ”´å¿…é¡»

```python
from core.security import require_permission

@router.delete("/posts/{id}")
async def delete_post(
    id: int,
    user = Depends(require_permission("blog.delete"))
):
    """åˆ é™¤æ–‡ç« ï¼ˆéœ€è¦blog.deleteæƒé™ï¼‰"""
    pass
```

### 10.4 è¾“å…¥éªŒè¯ ğŸ”´å¿…é¡»

æ‰€æœ‰ç”¨æˆ·è¾“å…¥å¿…é¡»é€šè¿‡Pydanticè¿›è¡ŒéªŒè¯ï¼š

```python
from pydantic import BaseModel, Field

class PostCreate(BaseModel):
    title: str = Field(..., min_length=1, max_length=200)
    content: str = Field(..., min_length=1)
```

---

## åä¸€ã€é™æ€èµ„æºè§„èŒƒ

### 11.1 URLæ˜ å°„ ğŸ”´å¿…é¡»

| èµ„æºç±»å‹ | URLè·¯å¾„ | ç‰©ç†è·¯å¾„ |
|----------|---------|----------|
| å‰ç«¯CSS | `/static/css/...` | `frontend/css/...` |
| å‰ç«¯JS | `/static/js/...` | `frontend/js/...` |
| æ¨¡å—èµ„æº | `/static/{module_id}/...` | `modules/{module_id}/static/...` |
| ç”¨æˆ·ä¸Šä¼  | `/storage/uploads/...` | `backend/storage/uploads/...` |

---

## åäºŒã€é”™è¯¯å¤„ç†è§„èŒƒ

### 12.1 å¼‚å¸¸æŠ›å‡º ğŸ”´å¿…é¡»

```python
from fastapi import HTTPException

# å‚æ•°é”™è¯¯
raise HTTPException(status_code=400, detail="å‚æ•°ä¸èƒ½ä¸ºç©º")

# æœªè®¤è¯
raise HTTPException(status_code=401, detail="è¯·å…ˆç™»å½•")

# æ— æƒé™
raise HTTPException(status_code=403, detail="æ— æƒæ‰§è¡Œæ­¤æ“ä½œ")

# ä¸å­˜åœ¨
raise HTTPException(status_code=404, detail="èµ„æºä¸å­˜åœ¨")
```

### 12.2 é”™è¯¯æ¶ˆæ¯ ğŸ”´å¿…é¡»

- å¿…é¡»ä½¿ç”¨ä¸­æ–‡
- å¿…é¡»æè¿°å…·ä½“é—®é¢˜
- ç¦æ­¢æš´éœ²ç³»ç»Ÿå†…éƒ¨ä¿¡æ¯

```python
# âœ… æ­£ç¡®
raise HTTPException(status_code=400, detail="æ–‡ç« æ ‡é¢˜ä¸èƒ½ä¸ºç©º")

# âŒ é”™è¯¯
raise HTTPException(status_code=400, detail="title is required")
raise HTTPException(status_code=500, detail=str(e))  # æš´éœ²å†…éƒ¨é”™è¯¯
```

---

## åä¸‰ã€ç‰ˆæœ¬ç®¡ç†

### 13.1 è¯­ä¹‰åŒ–ç‰ˆæœ¬ ğŸŸ¡åº”è¯¥

```
ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢å·

- ä¸»ç‰ˆæœ¬ï¼šä¸å…¼å®¹çš„APIå˜æ›´
- æ¬¡ç‰ˆæœ¬ï¼šå‘åå…¼å®¹çš„åŠŸèƒ½æ·»åŠ 
- ä¿®è®¢å·ï¼šå‘åå…¼å®¹çš„é—®é¢˜ä¿®å¤

ç¤ºä¾‹ï¼š1.0.0 â†’ 1.0.1ï¼ˆä¿®å¤ï¼‰ â†’ 1.1.0ï¼ˆåŠŸèƒ½ï¼‰ â†’ 2.0.0ï¼ˆä¸å…¼å®¹ï¼‰
```

---

## é™„å½•

### A. æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ | ç‰ˆæœ¬è¦æ±‚ |
|------|------|----------|
| Webæ¡†æ¶ | FastAPI | â‰¥0.104 |
| ORM | SQLAlchemy | â‰¥2.0 |
| æ•°æ®åº“ | MySQL | â‰¥8.0 |
| æ•°æ®éªŒè¯ | Pydantic | â‰¥2.0 |
| è®¤è¯ | python-jose | - |
| å¯†ç åŠ å¯† | bcrypt | â‰¥4.0 |
| å‰ç«¯ | åŸç”ŸJavaScript | ES6+ |

### B. ç¯å¢ƒå˜é‡

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ | å¿…å¡« |
|--------|------|--------|------|
| `DB_HOST` | æ•°æ®åº“ä¸»æœº | localhost | å¦ |
| `DB_PORT` | æ•°æ®åº“ç«¯å£ | 3306 | å¦ |
| `DB_USER` | æ•°æ®åº“ç”¨æˆ· | root | å¦ |
| `DB_PASSWORD` | æ•°æ®åº“å¯†ç  | - | æ˜¯ |
| `DB_NAME` | æ•°æ®åº“å | jeje_webos | å¦ |
| `JWT_SECRET` | JWTå¯†é’¥ | - | æ˜¯ |
| `JWT_SECRET_OLD` | æ—§JWTå¯†é’¥ï¼ˆè½®æ¢ç”¨ï¼‰ | - | å¦ |
| `JWT_EXPIRE_MINUTES` | Tokenæœ‰æ•ˆæœŸï¼ˆåˆ†é’Ÿï¼‰ | 10080 | å¦ |
| `JWT_AUTO_ROTATE` | å¯ç”¨è‡ªåŠ¨è½®æ¢ | true | å¦ |
| `JWT_ROTATE_INTERVAL_MIN` | è½®æ¢é—´éš”æœ€å°å€¼ï¼ˆå¤©ï¼‰ | 25 | å¦ |
| `JWT_ROTATE_INTERVAL_MAX` | è½®æ¢é—´éš”æœ€å¤§å€¼ï¼ˆå¤©ï¼‰ | 35 | å¦ |
| `JWT_ROTATE_CHECK_HOUR` | æ¯æ—¥æ£€æŸ¥æ—¶é—´ï¼ˆå°æ—¶ï¼‰ | 2 | å¦ |
| `JWT_ROTATE_CHECK_MINUTE` | æ¯æ—¥æ£€æŸ¥æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰ | 0 | å¦ |
| `ADMIN_USERNAME` | é»˜è®¤ç®¡ç†å‘˜ç”¨æˆ·å | admin | å¦ |
| `ADMIN_PASSWORD` | é»˜è®¤ç®¡ç†å‘˜å¯†ç  | admin123 | å¦ |
| `ADMIN_EMAIL` | é»˜è®¤ç®¡ç†å‘˜é‚®ç®± | - | å¦ |
| `ADMIN_NICKNAME` | é»˜è®¤ç®¡ç†å‘˜æ˜µç§° | ç³»ç»Ÿç®¡ç†å‘˜ | å¦ |
| `DEBUG` | è°ƒè¯•æ¨¡å¼ | false | å¦ |

### C. è™šæ‹Ÿç¯å¢ƒè§„èŒƒ ğŸŸ¡åº”è¯¥

**è™šæ‹Ÿç¯å¢ƒä½ç½®ï¼š**

è™šæ‹Ÿç¯å¢ƒåº”åˆ›å»ºåœ¨ `backend/` ç›®å½•ä¸‹ï¼Œå‘½åè§„èŒƒï¼š
- `backend/venv/` ï¼ˆæ¨èï¼‰
- `backend/.venv/`
- `backend/env/`

**åŸå› ï¼š**
- è™šæ‹Ÿç¯å¢ƒä»…ç”¨äºåç«¯Pythoné¡¹ç›®
- ä¸ä»£ç åœ¨åŒä¸€ç›®å½•ï¼Œä¾¿äºç®¡ç†
- é¿å…æ ¹ç›®å½•æ–‡ä»¶è¿‡å¤š

**åˆ›å»ºå’Œä½¿ç”¨ï¼š**

```bash
# è¿›å…¥åç«¯ç›®å½•
cd backend

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆPython 3.8+ï¼‰
python -m venv venv

# Windowsæ¿€æ´»
venv\Scripts\activate

# Linux/Macæ¿€æ´»
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# é€€å‡ºè™šæ‹Ÿç¯å¢ƒ
deactivate
```

**æ³¨æ„äº‹é¡¹ï¼š**
- è™šæ‹Ÿç¯å¢ƒç›®å½•å·²åŠ å…¥ `.gitignore`ï¼Œä¸ä¼šè¢«æäº¤
- æ¯ä¸ªå¼€å‘è€…éœ€è¦å•ç‹¬åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
- ç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨Dockerå®¹å™¨

### D. å¿«é€Ÿå¯åŠ¨

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository_url>
cd jeje_webos

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆåœ¨backendç›®å½•ï¼‰
cd backend
python -m venv venv

# 3. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows:
venv\Scripts\activate
# Linux/Mac:
source venv/bin/activate

# 4. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 5. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å†™æ•°æ®åº“å¯†ç å’ŒJWTå¯†é’¥

# 6. å¯åŠ¨æœåŠ¡
python main.py

# 7. è®¿é—®
# å‰ç«¯é¡µé¢: http://localhost:8000/
# APIæ–‡æ¡£: http://localhost:8000/api/docs
```

---

## æ–‡æ¡£ç‰ˆæœ¬

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¿®è®¢å†…å®¹ |
|------|------|----------|
| 1.0.0 | 2025-12-05 | åˆå§‹ç‰ˆæœ¬ |

---

> **é‡è¦æç¤º**ï¼šæœ¬è§„èŒƒæ˜¯é¡¹ç›®çš„åŸºç¡€æ³•è§„ï¼Œä»»ä½•è¿åè§„èŒƒçš„ä»£ç ä¸å¾—åˆå¹¶åˆ°ä¸»åˆ†æ”¯ã€‚å¦‚æœ‰ç–‘é—®ï¼Œè¯·åœ¨å¼€å‘å‰ä¸å›¢é˜Ÿç¡®è®¤ã€‚
