# 知识库模块优化方案报告

## 1. 已实施优化 (Implemented)

### 1.1 智能文档解析 (Smart Parsing)
- **递归字符切分**: 引入了 `RecursiveCharacterTextSplitter` 算法，取代了原有的固定窗口切分。现在能更好地尊重段落、句子结构，显著提升 RAG 检索的上下文连贯性。
- **OCR 支持**: 集成了 `PaddleOCR`。现在系统可以自动识别图片 (`.jpg`, `.png`) 中的文字，并将其存入知识库。
- **异步处理**: 将原本可能阻塞主线程的解析任务移至线程池 (`ThreadPoolExecutor`) 执行，提升了后端并发处理能力。

### 1.2 用户体验升级 (UX Improvements)
- **面包屑导航**: 在知识库浏览界面添加了面包屑导航栏，支持快速跳转至父级目录，改善了深层文件夹的导航体验。
- **界面样式**: 优化了导航栏的交互反馈和视觉样式。

## 2. 潜在优化空间 (Potential Optimizations)

### 2.1 检索增强 (Retrieval Enhancements)
- **混合检索 (Hybrid Search)**: 目前仅使用向量检索 (Semantic Search)。建议引入关键词检索 (BM25) 并进行加权融合，以解决专业术语匹配不准的问题。
- **重排序 (Reranking)**: 在初步检索由于召回 Top-N 文档后，引入 Cross-Encoder 模型（如 `bge-reranker`）对结果进行精细重排序，可大幅提升最终回答的准确率。
- **元数据过滤**: 支持在搜索时按照“文件类型”、“创建时间”或“标签”进行过滤。

### 2.2 性能与架构 (Performance & Architecture)
- **向量库优化**: `ChromaDB` 目前运行在本地模式。随着数据量增加，建议配置 HNSW 索引参数以平衡写入速度和查询速度，或迁移至独立服务器部署。
- **任务队列**: 文件上传和解析目前是 HTTP 请求内的异步任务。对于大文件，建议引入 `Celery` 或 `Redis Queue` 进行后台异步处理，并提供进度条反馈。

### 2.3 功能扩展 (Feature Extensions)
- **多模态检索**: 目前 OCR 仅将图片转文字。未来可引入 CLIP 模型，直接实现“以文搜图”或“以图搜图”。
- **知识图谱**: 提取文档中的实体和关系，构建知识图谱，辅助复杂推理。

## 3. 下一步建议
建议优先落地 **混合检索** 和 **后台任务队列**，以进一步提升系统的准确性和稳定性。
