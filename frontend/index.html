<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/static/images/logo.png">
    <link rel="shortcut icon" href="/favicon.ico">
    <title>JeJe WebOS</title>
    <link rel="manifest" href="/manifest.json">

    <!-- ========== DNS 预获取（提前解析第三方域名） ========== -->
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="preconnect" href="//cdn.jsdelivr.net" crossorigin>

    <!-- ========== 关键资源预加载 ========== -->
    <!-- 图标字体预加载（首屏必需） -->
    <link rel="preload" href="/static/libs/remixicon/remixicon.woff2?t=1708865856766" as="font" type="font/woff2"
        crossorigin>
    <!-- 核心 CSS 预加载 -->
    <link rel="preload" href="/static/css/core/variables.css" as="style">
    <link rel="preload" href="/static/css/core/reset.css" as="style">
    <!-- 核心 JS 预加载 -->
    <link rel="preload" href="/static/js/core/config.js" as="script">
    <link rel="preload" href="/static/js/core/api.js" as="script">
    <!-- Logo 图片预加载 -->
    <link rel="preload" href="/static/images/logo.png" as="image" type="image/png">

    <!-- ========== 第三方库 ========== -->
    <link rel="stylesheet" href="/static/libs/remixicon/remixicon.css">
    <link rel="stylesheet" href="/static/libs/leaflet/leaflet.css">
    <script src="/static/libs/leaflet/leaflet.js" defer></script>
    <script src="/static/libs/echarts/echarts.min.js" defer></script>

    <!-- ========== 核心样式（首屏必需） ========== -->
    <link rel="stylesheet" href="/static/css/core/variables.css">
    <link rel="stylesheet" href="/static/css/core/reset.css">
    <link rel="stylesheet" href="/static/css/core/utils.css">
    <link rel="stylesheet" href="/static/css/core/button.css">
    <link rel="stylesheet" href="/static/css/core/card.css">
    <link rel="stylesheet" href="/static/css/core/form.css">
    <link rel="stylesheet" href="/static/css/core/search.css">
    <link rel="stylesheet" href="/static/css/core/table.css">
    <link rel="stylesheet" href="/static/css/core/tag.css">
    <link rel="stylesheet" href="/static/css/core/pagination.css">
    <link rel="stylesheet" href="/static/css/core/lazy.css">

    <!-- ========== 组件样式（首屏必需） ========== -->
    <link rel="stylesheet" href="/static/css/components/modal.css">
    <link rel="stylesheet" href="/static/css/components/toast.css">
    <link rel="stylesheet" href="/static/css/components/sidebar.css">
    <link rel="stylesheet" href="/static/css/components/header.css">
    <link rel="stylesheet" href="/static/css/components/spotlight.css">
    <link rel="stylesheet" href="/static/css/components/shortcuts_help.css">
    <link rel="stylesheet" href="/static/css/components/data_tools.css">
    <link rel="stylesheet" href="/static/css/components/dock.css">
    <link rel="stylesheet" href="/static/css/components/topbar.css">
    <link rel="stylesheet" href="/static/css/components/start_menu.css">
    <link rel="stylesheet" href="/static/css/components/module_help.css">
    <link rel="stylesheet" href="/static/css/components/office_viewer.css">
    <link rel="stylesheet" href="/static/css/components/pdf_viewer.css">

    <!-- ========== 页面样式 - 首屏必需 ========== -->
    <link rel="stylesheet" href="/static/css/pages/layout.css">
    <link rel="stylesheet" href="/static/css/pages/desktop.css">
    <link rel="stylesheet" href="/static/css/pages/login.css">
    <link rel="stylesheet" href="/static/css/pages/profile.css">
    <link rel="stylesheet" href="/static/css/pages/help.css">
    <link rel="stylesheet" href="/static/css/pages/features.css">
    <link rel="stylesheet" href="/static/css/pages/messages.css">

    <!-- ========== 页面样式 - 按需加载（CSS 懒加载） ========== -->
    <!--
    以下样式由 ResourceLoader 在访问对应路由时动态加载:
    系统管理、文件管理、媒体工具、学习办公、通讯AI、数据分析等模块样式
    -->
</head>

<body>
    <div id="app">
        <!-- 应用容器，由JS动态渲染 -->
        <div class="loading-screen">
            <div class="loader"></div>
            <p>正在加载系统...</p>
        </div>
    </div>

    <!-- ========== 核心脚本（同步加载，保证执行顺序） ========== -->
    <script src="/static/js/core/config.js"></script>
    <script src="/static/js/core/api.js"></script>
    <script src="/static/js/core/store.js"></script>
    <script src="/static/js/core/router.js"></script>
    <script src="/static/js/core/component.js"></script>
    <script src="/static/js/core/loader.js"></script>
    <script src="/static/js/core/window_manager.js"></script>
    <script src="/static/js/core/websocket.js"></script>
    <script src="/static/js/core/notification.js"></script>

    <!-- ========== 核心工具脚本（defer 延迟加载） ========== -->
    <script src="/static/js/core/lazy_loader.js" defer></script>
    <script src="/static/js/core/shortcut_manager.js" defer></script>

    <!-- ========== 组件脚本 - 帮助系统（defer 延迟加载） ========== -->
    <script src="/static/js/components/module_help/module_help.js" defer></script>
    <script src="/static/js/components/module_help/module_help_contents.js" defer></script>

    <!-- ========== 组件脚本 - 图表工具（defer 延迟加载） ========== -->
    <script src="/static/js/components/chart/chart_style_config.js" defer></script>
    <script src="/static/js/components/chart/chart_helper.js" defer></script>
    <script src="/static/js/components/chart/chart_factory.js" defer></script>
    <script src="/static/js/components/chart/chart_render_cache.js" defer></script>
    <script src="/static/js/components/chart/chart_config_ui.js" defer></script>

    <!-- ========== 组件脚本（defer 延迟加载） ========== -->
    <script src="/static/js/components/modal.js" defer></script>
    <script src="/static/js/components/toast.js" defer></script>
    <script src="/static/js/components/shortcuts_help.js" defer></script>
    <script src="/static/js/components/data_tools.js" defer></script>
    <script src="/static/js/components/dock.js" defer></script>
    <script src="/static/js/components/topbar.js" defer></script>
    <script src="/static/js/components/start_menu.js" defer></script>
    <script src="/static/js/components/spotlight.js" defer></script>
    <script src="/static/js/components/office_viewer.js" defer></script>
    <script src="/static/js/components/pdf_viewer.js" defer></script>

    <!-- ========== 页面脚本 - 基础（defer 延迟加载） ========== -->
    <script src="/static/js/pages/login.js" defer></script>
    <script src="/static/js/pages/desktop.js" defer></script>
    <script src="/static/js/pages/profile.js" defer></script>
    <script src="/static/js/pages/help.js" defer></script>
    <script src="/static/js/pages/messages.js" defer></script>

    <!-- ========== 页面脚本 - 系统管理（defer 延迟加载） ========== -->
    <script src="/static/js/pages/system.js" defer></script>
    <script src="/static/js/pages/users.js" defer></script>
    <script src="/static/js/pages/roles.js" defer></script>
    <script src="/static/js/pages/backup.js" defer></script>
    <script src="/static/js/pages/monitor.js" defer></script>
    <script src="/static/js/pages/import-export.js" defer></script>
    <script src="/static/js/pages/announcement.js" defer></script>
    <script src="/static/js/pages/feedback.js" defer></script>
    <script src="/static/js/pages/market.js" defer></script>
    <script src="/static/js/pages/theme_editor.js" defer></script>

    <!-- ========== 页面脚本 - 文件与内容（defer 延迟加载） ========== -->
    <script src="/static/js/pages/filemanager.js" defer></script>
    <script src="/static/js/pages/transfer.js" defer></script>
    <script src="/static/js/pages/blog.js" defer></script>
    <script src="/static/js/pages/notes.js" defer></script>
    <script src="/static/js/pages/knowledge.js" defer></script>
    <script src="/static/js/pages/vault.js" defer></script>

    <!-- ========== 页面脚本 - 媒体工具（defer 延迟加载） ========== -->
    <script src="/static/js/pages/album.js" defer></script>
    <script src="/static/js/pages/video.js" defer></script>
    <script src="/static/js/pages/ocr.js" defer></script>
    <script src="/static/js/pages/lm_cleaner.js" defer></script>
    <script src="/static/js/pages/pdf/pdf_utils.js" defer></script>
    <script src="/static/js/pages/pdf/pdf_reader.js" defer></script>
    <script src="/static/js/pages/pdf/pdf_toolbox.js" defer></script>
    <script src="/static/js/pages/pdf/pdf_history.js" defer></script>
    <script src="/static/js/pages/pdf/pdf_documents.js" defer></script>
    <script src="/static/js/pages/pdf/pdf.js" defer></script>
    <script src="/static/js/pages/markdown/markdown_wysiwyg.js" defer></script>
    <script src="/static/js/pages/markdown/markdown.js" defer></script>

    <!-- ========== 页面脚本 - 学习与办公（defer 延迟加载） ========== -->
    <script src="/static/js/pages/exam.js" defer></script>
    <script src="/static/js/pages/course.js" defer></script>
    <script src="/static/js/pages/schedule.js" defer></script>

    <!-- ========== 页面脚本 - 通讯与AI（defer 延迟加载） ========== -->
    <script src="/static/js/pages/im/components.js" defer></script>
    <script src="/static/js/pages/im/im.js" defer></script>
    <script src="/static/js/pages/ai.js" defer></script>
    <script src="/static/js/pages/map.js" defer></script>

    <!-- ========== 页面脚本 - 数据分析（defer 延迟加载） ========== -->
    <script src="/static/js/pages/analysis/analysis.js" defer></script>
    <script src="/static/js/pages/analysis/analysis_import.js" defer></script>
    <script src="/static/js/pages/analysis/analysis_cleaning.js" defer></script>
    <script src="/static/js/pages/analysis/analysis_modeling.js" defer></script>
    <script src="/static/js/pages/analysis/analysis_chart.js" defer></script>
    <script src="/static/js/pages/analysis/analysis_sql.js" defer></script>
    <script src="/static/js/pages/analysis/analysis_compare.js" defer></script>
    <script src="/static/js/pages/analysis/analysis_bi.js" defer></script>
    <script src="/static/js/pages/analysis/analysis_smart_table.js" defer></script>

    <!-- ========== 页面脚本 - 数据透镜（defer 延迟加载） ========== -->
    <script src="/static/js/pages/datalens/datalens_api.js" defer></script>
    <script src="/static/js/pages/datalens/datalens.js" defer></script>
    <script src="/static/js/pages/datalens/datalens_hub.js" defer></script>
    <script src="/static/js/pages/datalens/datalens_viewer.js" defer></script>
    <script src="/static/js/pages/datalens/datalens_editor.js" defer></script>

    <!-- ========== 应用入口（必须在所有页面脚本之后） ========== -->
    <script src="/static/js/pages/app.js" defer></script>

    <!-- ========== PWA Service Worker ========== -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('ServiceWorker 注册成功，作用域: ', registration.scope);
                    })
                    .catch(err => {
                        console.log('ServiceWorker 注册失败: ', err);
                    });
            });
        }
    </script>
</body>

</html>